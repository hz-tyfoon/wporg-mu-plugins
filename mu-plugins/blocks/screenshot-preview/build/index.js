!function(){"use strict";var e=window.wp.element;function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(this,arguments)}var n=window.lodash,r=window.wp.i18n,s=function(t){let{alt:n="",queryString:s,src:o,isReady:c=!1}=t;const a=`https://s0.wp.com/mshots/v1/${encodeURIComponent(o)}${s}`,[i,u]=(0,e.useState)(0),[l,d]=(0,e.useState)(!1),[w,f]=(0,e.useState)(!1),[h,p]=(0,e.useState)(""),v=i>10,g=c&&!l&&!v&&!w;return function(t,n){const r=(0,e.useRef)();(0,e.useEffect)((()=>{r.current=t}),[t]),(0,e.useEffect)((()=>{if(null!==n){const e=setInterval((function(){r.current()}),n);return()=>clearInterval(e)}}),[n])}((async()=>{try{const e=await fetch(a);200!==e.status||e.redirected?u(i+1):(await(async e=>{const t=await e.blob(),n=new FileReader;n.onload=e=>{p(e.target.result)},n.readAsDataURL(t)})(e),d(!0))}catch(e){f(!0)}}),g?1e3:null),c?g?(0,e.createElement)("div",{className:"wporg-screenshot wporg-screenshot-loader"}):w||v?(0,e.createElement)("div",{className:"wporg-screenshot wporg-screenshot__has-error"},(0,r.__)("error","wporg")):(0,e.createElement)("img",{src:h,alt:n}):null},o=function(r){let{link:o,previewLink:c,caption:a,height:i="1px",width:u="100%",aspectRatio:l=2/3,queryString:d="?vpw=1200&vph=800",anchorTagProps:w={}}=r;const f=(0,e.useRef)(),[h,p]=(0,e.useState)(i),v=(t=>{let{element:r}=t;const[s,o]=(0,e.useState)(null);(0,e.useEffect)((()=>{if(!r.current)return;const e=(0,n.debounce)(c,100);return c(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.addEventListener("resize",e)}}),[r]);const c=()=>{if(!r.current)return;const e=window.innerHeight;if(null===r.current.offsetParent)return void o(!1);const{top:t}=r.current.getBoundingClientRect();o(t>=0&&t<=e)};return s})({element:f}),[g,m]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=()=>{try{p(function(e,t){return e*t}(f.current.clientWidth,l))}catch(e){}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[g]),(0,e.useEffect)((()=>{v&&m(!0)}),[v]),(0,e.createElement)("a",t({className:"wporg-screenshot-card",ref:f,style:{height:h,width:u},href:o},w),(0,e.createElement)(s,{queryString:d,src:c,isReady:g,alt:a}))};const c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wporg-screenshot-preview-js";const n=document.getElementsByClassName(t);if(n)for(let t=0;t<n.length;t++){const r=n[t];(0,e.render)((0,e.createElement)(o,r.dataset),r)}};document.addEventListener("DOMContentLoaded",c),window.__wporg_screenshot_preview_render=c}();